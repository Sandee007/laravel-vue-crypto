import n from"locutus/php/var/unserialize";import a from"crypto-js";export default class{constructor(r){this.APP_KEY=a.enc.Base64.parse(r.slice(7))}encrypt(r){return{payload:e(r,this.APP_KEY)}}decrypt(r){return t(r,this.APP_KEY)}}function e(r,e){var t=a.lib.WordArray.random(16),n={iv:t,mode:a.mode.CBC,padding:a.pad.Pkcs7};let i=a.AES.encrypt(JSON.stringify(r),e,n);i=i.toString();r={iv:t=a.enc.Base64.stringify(t),value:i,mac:a.HmacSHA256(t+i,e).toString()},r=JSON.stringify(r);return r=a.enc.Utf8.parse(r),a.enc.Base64.stringify(r)}function t(r,e){var r=a.enc.Base64.parse(r).toString(a.enc.Utf8),r=JSON.parse(r),t=a.enc.Base64.parse(r.iv),r=a.AES.decrypt(r.value,e,{iv:t}).toString(a.enc.Utf8),e=n(r);return JSON.parse(e)}